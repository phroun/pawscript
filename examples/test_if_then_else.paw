#!/usr/bin/env paw

echo "=== Testing If/Then/Else Keywords ==="
echo ""

# Test 1: Basic if with then
echo "Test 1: Basic if-then"
if true then echo "This should print"
if false then echo "This should NOT print"
echo ""

# Test 2: If with else
echo "Test 2: If-then-else"
if true then echo "True branch" else echo "False branch"
if false then echo "True branch" else echo "False branch"
echo ""

# Test 3: If with blocks
echo "Test 3: If-then-else with blocks"
if true then (
    echo "  Statement 1 in true branch";
    echo "  Statement 2 in true branch"
) else (
    echo "  Statement 1 in false branch";
    echo "  Statement 2 in false branch"
)
echo ""

# Test 4: If normalizing truthy values
echo "Test 4: If normalizing truthy/falsy values"
if 1 then echo "  1 is truthy"
if 0 then echo "  0 should NOT print (falsy)"
if "hello" then echo "  'hello' is truthy"
if "" then echo "  Empty string should NOT print (falsy)"
if "false" then echo "  'false' string should NOT print (falsy)"
echo ""

# Test 5: If with comparison results
echo "Test 5: If with comparisons"
set x, 10
set y, 5

if {gt {get x}, {get y}} then (
    echo "  x ({get x}) > y ({get y})"
) else (
    echo "  x <= y"
)

if {eq {get x}, {get y}} then (
    echo "  x == y"
) else (
    echo "  x ({get x}) != y ({get y})"
)
echo ""

# Test 6: Nested if statements
echo "Test 6: Nested if statements"
set role, "admin"
set active, true

if {eq {get role}, "admin"} then (
    echo "  User is admin";
    if {get active} then (
        echo "    And user is active"
    ) else (
        echo "    But user is inactive"
    )
) else (
    echo "  User is not admin"
)
echo ""

# Test 7: Word boundary test - "then" inside another word
echo "Test 7: Word boundary test"
set athena, "goddess"
echo "athena = {get athena}"
# This should work - "then" is part of "athena", not a keyword
echo ""

# Test 8: Complex workflow with if/then/else
echo "Test 8: Complex workflow"
set score, 95

if {gt {get score}, 90} then (
    set grade, "A";
    set message, "Excellent!"
) else (
    if {gt {get score}, 80} then (
        set grade, "B";
        set message, "Good job!"
    ) else (
        set grade, "C";
        set message, "Keep trying!"
    )
)

echo "  Score: {get score}"
echo "  Grade: {get grade}"
echo "  Message: {get message}"
echo ""

# Test 9: If with while loop
echo "Test 9: If with while loop"
set counter, 0
while (lt {get counter}, 3), (
    if {eq {get counter}, 1} then (
        echo "  Counter is 1 - special case!"
    ) else (
        echo "  Counter is {get counter}"
    );
    set counter, {add {get counter}, 1}
)
echo ""

# Test 10: Setting variables based on conditions
echo "Test 10: Conditional variable assignment"
set authenticated, false
set username, "admin"

if {eq {get username}, "admin"} then (
    set authenticated, true;
    set accessLevel, "full"
) else (
    set authenticated, false;
    set accessLevel, "limited"
)

echo "  Username: {get username}"
echo "  Authenticated: {get authenticated}"
echo "  Access Level: {get accessLevel}"
echo ""

echo "=== All If/Then/Else Tests Complete ==="
