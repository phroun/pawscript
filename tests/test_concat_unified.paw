#!/usr/bin/env paw
# Test unified polymorphic concat function

echo "=== UNIFIED CONCAT TESTS ==="
print

# ==========================================
# String concatenation
# ==========================================
echo "Test 1: String concatenation"
result: {concat "hello", " ", "world"}
echo "Result: ~result"
echo "Expected: hello world"
print

echo "Test 2: Multi-string concatenation"
result: {concat "a", "b", "c", "d", "e"}
echo "Result: ~result"
echo "Expected: abcde"
print

# ==========================================
# List concatenation
# ==========================================
echo "Test 3: Two lists"
list1: {list "a", "b", "c"}
list2: {list "d", "e", "f"}
result: {concat ~list1, ~list2}
echo "Result length: {len ~result}"
echo "Expected: 6"
echo "First item: {argv ~result, 1}"
echo "Expected: a"
echo "Last item: {argv ~result, 6}"
echo "Expected: f"
print

# ==========================================
# Mixed: list + items
# ==========================================
echo "Test 4: List + individual items"
list1: {list "a", "b", "c"}
result: {concat ~list1, "d", "e", "f"}
echo "Result length: {len ~result}"
echo "Expected: 6"
echo "Items 4-6: {argv ~result, 4}, {argv ~result, 5}, {argv ~result, 6}"
echo "Expected: d, e, f"
print

# ==========================================
# Mixed: list + list + items
# ==========================================
echo "Test 5: List + list + items"
list1: {list "a", "b"}
list2: {list "c", "d"}
result: {concat ~list1, ~list2, "e", "f"}
echo "Result length: {len ~result}"
echo "Expected: 6"
echo "All items: {join ~result, ","}"
echo "Expected: a,b,c,d,e,f"
print

# ==========================================
# Edge case: Numbers and mixed types
# ==========================================
echo "Test 6: String concatenation with numbers"
result: {concat "Count: ", 42, " items"}
echo "Result: ~result"
echo "Expected: Count: 42 items"
print

echo "Test 7: List with mixed type items"
list1: {list "text", 123}
result: {concat ~list1, true, "more"}
echo "Result length: {len ~result}"
echo "Expected: 4"
echo "Item 3: {argv ~result, 3}"
echo "Expected: true"
print

# ==========================================
# Edge case: Empty list concatenation
# ==========================================
echo "Test 8: Empty list + items"
empty: {list}
result: {concat ~empty, "a", "b", "c"}
echo "Result length: {len ~result}"
echo "Expected: 3"
print

# ==========================================
# Practical use cases
# ==========================================
echo "Test 9: Building a path"
parts: {list "home", "user", "documents"}
path: {concat "/", {join ~parts, "/"}}
echo "Path: ~path"
echo "Expected: /home/user/documents"
print

echo "Test 10: Accumulating items"
base: {list "item1"}
base: {concat ~base, "item2"}
base: {concat ~base, "item3"}
echo "Final length: {len ~base}"
echo "Expected: 3"
echo "All: {join ~base, ", "}"
echo "Expected: item1, item2, item3"
print

echo "=== ALL CONCAT TESTS COMPLETE ==="
