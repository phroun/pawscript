#!/usr/bin/env paw

echo "=== Testing If/Then/Else Keywords ==="
echo ""

# Test 1: Basic if with then
echo "Test 1: Basic if-then"
if true then echo "This should print"
if false then echo "This should NOT print"
echo ""

# Test 2: If with else
echo "Test 2: If-then-else"
if true then echo "True branch Good" else echo "False branch Bad"
if false then echo "True branch Bad" else echo "False branch Good"
echo ""

# Test 3: If with blocks
echo "Test 3: If-then-else with blocks"
if true then (
    echo "  Statement 1 in true branch";
    echo "  Statement 2 in true branch"
) else (
    echo "  Statement 1 in false branch";
    echo "  Statement 2 in false branch"
)
echo ""

# Test 4: If normalizing truthy values
echo "Test 4: If normalizing truthy/falsy values"
if 1 then echo "  1 is truthy"
if 0 then echo "  0 should NOT print (falsy)"
if "hello" then echo "  'hello' is truthy"
if "" then echo "  Empty string should NOT print (falsy)"
if "false" then echo "  'false' string should NOT print (falsy)"
echo ""

# Test 5: If with comparison results
echo "Test 5: If with comparisons"
x: 10
y: 5

if {gt ~x, ~y} then (
    echo "  x ({set_result ~x}) > y ({set_result ~y})"
) else (
    echo "  x <= y"
)

if {eq ~x, ~y} then (
    echo "  x == y"
) else (
    echo "  x ({set_result ~x}) != y ({set_result ~y})"
)
echo ""

# Test 6: Nested if statements
echo "Test 6: Nested if statements"
role: "admin"
active: true

if {eq ~role, "admin"} then (
    echo "  User is admin";
    if {set_result ~active} then (
        echo "    And user is active"
    ) else (
        echo "    But user is inactive"
    )
) else (
    echo "  User is not admin"
)
echo ""

# Test 7: Word boundary test - "then" inside another word
echo "Test 7: Word boundary test"
athena: "goddess"
echo "athena = {set_result ~athena}"
# This should work - "then" is part of "athena", not a keyword
echo ""

# Test 8: Complex workflow with if/then/else
echo "Test 8: Complex workflow"
score: 95

if {gt ~score, 90} then (
    grade: "A";
    message: "Excellent!"
) else (
    if {gt ~score, 80} then (
        grade: "B";
        message: "Good job!"
    ) else (
        grade: "C";
        message: "Keep trying!"
    )
)

echo "  Score: {set_result ~score}"
echo "  Grade: {set_result ~grade}"
echo "  Message: {set_result ~message}"
echo ""

# Test 9: If with while loop
echo "Test 9: If with while loop"
counter: 0
while (lt ~counter, 3), (
    if {eq ~counter, 1} then (
        echo "  Counter is 1 - special case!"
    ) else (
        echo "  Counter is {set_result ~counter}"
    );
    counter: {add ~counter, 1}
)
echo ""

# Test 10: Setting variables based on conditions
echo "Test 10: Conditional variable assignment"
authenticated: false
username: "admin"

if {eq ~username, "admin"} then (
    authenticated: true;
    accessLevel: "full"
) else (
    authenticated: false;
    accessLevel: "limited"
)

echo "  Username: {set_result ~username}"
echo "  Authenticated: {set_result ~authenticated}"
echo "  Access Level: {set_result ~accessLevel}"
echo ""

echo "=== All If/Then/Else Tests Complete ==="
