=== JSON Serialization Tests ===

Test 1: Simple array (auto mode)
  json: [1,2,3,"hello",true]

Test 2: Simple object (auto mode)
  json: {"active":true,"age":30,"name":"Alice"}

Test 3: Mixed list - auto mode
  json: {"_children":[1,2,3],"name":"test","value":42}

Test 4: Mixed list - explicit mode
  json: {"_children":[1,2,3],"name":"test","value":42}

Test 5: Explicit with custom children
  json: {"items":[1,2,3],"name":"test","value":42}

Test 6: Mixed list - merge mode
  json: {"0":"a","1":"b","2":"c","x":10,"y":20}

Test 7: Named mode (discards positional)
  json: {"name":"test","value":42}

Test 8: Named mode with children
  json: {"data":[1,2,3],"name":"test","value":42}

Test 9: Array mode (discards named)
  json: [1,2,3]

Test 10: Array_1 mode
  json: [{"name":"test","value":42},1,2,3]

Test 11: Nested lists
  json: [[1,2,3],{"a":1,"b":2},"standalone"]

Test 12: Deeply nested
  json: {"_children":[{"_children":[1,2]},{"x":10,"y":20},{"nested":{"_children":["a","b","c"]}}]}

Test 13: Empty list
  json: []

Test 14: Floats and special values
  json: [3.14,2.718,-1.5,0]

Test 15: Nil values
  json: {"_children":[1,null,3],"value":null}

Test 16: Strings with escapes
  json: ["hello\"world","back\\slash","tab\there"]

Test 17: Bytes
  json: {"_children":[[65,66,67,68]],"extra":"data"}

Test 18: Complex escapes in named args
  json: {"multi":"line1\nline2","path":"C:\\Users\\Name","title":"Say \"Hello\""}

Test 19: Various string types
  json: ["simple","single","bareword",123,45.67]

Test 20: Complex nested structure
  json: {"child":{"_children":[{"deep":"value","num":42}],"items":{"_children":[1,2,3]}},"name":"root","tags":{"_children":["a","b","c"]}}

Test 21: Bytes including null and high values
  json: {"data":[0,127,128,255,10,13]}

Test 22: Merge mode with numeric key conflict
[PawScript:type ERROR] json merge mode: numeric key '0' conflicts with named key
  at line 133, column 10 in tests/test_json.paw
  result: 
  status: true

=== Error Cases ===

Test 23: Channel in list (should error)
[PawScript:type ERROR] json: list contains unserializable positional items
  at line 146, column 10 in tests/test_json.paw
  result: 
  status: true

Test 24: Channel in named args (should error)
[PawScript:type ERROR] json: list contains unserializable named items
  at line 154, column 10 in tests/test_json.paw
  result: 
  status: true

Test 25: Unknown mode
[PawScript:type ERROR] json: unknown mode 'badmode'
  at line 162, column 10 in tests/test_json.paw
  result: 
  status: true

=== Len Command Keys Tests ===

Test 26: len default
  len: 3

Test 27: len keys_only
  len keys_only: 3

Test 28: len keys (both)
  len keys: 6

Test 29: len on positional-only list
  len: 5
  len keys_only: 0
  len keys: 5

Test 30: len on named-only list
  len: 0
  len keys_only: 3
  len keys: 3

Test 31: arrlen and maplen
  arrlen on mixed: 3
  maplen on mixed: 3
  arrlen on posonly: 5
  maplen on posonly: 0
  arrlen on namedonly: 0
  maplen on namedonly: 3

=== Tests Complete ===
