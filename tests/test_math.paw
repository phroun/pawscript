#!/usr/bin/env paw
# Comprehensive test for math module operations

echo "=== Math Module Tests ==="
echo ""

# Test 1: add - variadic addition
echo "Test 1: add (variadic)"
echo "add 1,2 = {add 1,2}"
echo "add 1,2,3 = {add 1,2,3}"
echo "add 1,2,3,4,5 = {add 1,2,3,4,5}"
echo "add 10.5,20.5 = {add 10.5,20.5}"
echo "add -5,10,-3 = {add -5,10,-3}"
echo "(Expected: 3, 6, 15, 31, 2)"
echo ""

# Test 2: sub - variadic subtraction
echo "Test 2: sub (variadic - first minus rest)"
echo "sub 10,3 = {sub 10,3}"
echo "sub 100,20,5,3 = {sub 100,20,5,3}"
echo "sub 50,10,10,10 = {sub 50,10,10,10}"
echo "sub -10,5 = {sub -10,5}"
echo "sub 100.5,50.25 = {sub 100.5,50.25}"
echo "(Expected: 7, 72, 20, -15, 50.25)"
echo ""

# Test 3: mul - variadic multiplication
echo "Test 3: mul (variadic)"
echo "mul 2,3 = {mul 2,3}"
echo "mul 2,3,4 = {mul 2,3,4}"
echo "mul 1,2,3,4,5 = {mul 1,2,3,4,5}"
echo "mul -2,3 = {mul -2,3}"
echo "mul -2,-3 = {mul -2,-3}"
echo "mul 2.5,4 = {mul 2.5,4}"
echo "(Expected: 6, 24, 120, -6, 6, 10)"
echo ""

# Test 4: idiv - floored integer division
echo "Test 4: idiv (floored integer division)"
echo "idiv 17,5 = {idiv 17,5}"
echo "idiv 15,5 = {idiv 15,5}"
echo "idiv -17,5 = {idiv -17,5}"
echo "idiv 17,-5 = {idiv 17,-5}"
echo "idiv -17,-5 = {idiv -17,-5}"
echo "idiv 100,2,5 = {idiv 100,2,5}"
echo "(Expected: 3, 3, -4, -4, 3, 10)"
echo ""

# Test 5: fdiv - floating point division
echo "Test 5: fdiv (floating point division)"
echo "fdiv 17,5 = {fdiv 17,5}"
echo "fdiv 10,4 = {fdiv 10,4}"
echo "fdiv -17,5 = {fdiv -17,5}"
echo "fdiv 100,2,5 = {fdiv 100,2,5}"
echo "(Expected: 3.4, 2.5, -3.4, 10)"
echo ""

# Test 6: iremainder - integer remainder (sign from dividend)
echo "Test 6: iremainder (sign from dividend)"
echo "iremainder 17,5 = {iremainder 17,5}"
echo "iremainder -17,5 = {iremainder -17,5}"
echo "iremainder 17,-5 = {iremainder 17,-5}"
echo "iremainder -17,-5 = {iremainder -17,-5}"
echo "iremainder 100,2,3 = {iremainder 100,2,3}"
echo "(Expected: 2, -2, 2, -2, 4)"
echo ""

# Test 7: imodulo - integer modulo (sign from divisor)
echo "Test 7: imodulo (sign from divisor)"
echo "imodulo 17,5 = {imodulo 17,5}"
echo "imodulo -17,5 = {imodulo -17,5}"
echo "imodulo 17,-5 = {imodulo 17,-5}"
echo "imodulo -17,-5 = {imodulo -17,-5}"
echo "imodulo 100,2,3 = {imodulo 100,2,3}"
echo "(Expected: 2, 3, -3, -2, 4)"
echo ""

# Test 8: fremainder - floating point remainder
echo "Test 8: fremainder (floating point, sign from dividend)"
echo "fremainder 17.5,3 = {fremainder 17.5,3}"
echo "fremainder -17.5,3 = {fremainder -17.5,3}"
echo "fremainder 17.5,-3 = {fremainder 17.5,-3}"
echo "(Expected: -0.5, 0.5, -0.5)"
echo ""

# Test 9: fmodulo - floating point modulo
echo "Test 9: fmodulo (floating point, sign from divisor)"
echo "fmodulo 17.5,3 = {fmodulo 17.5,3}"
echo "fmodulo -17.5,3 = {fmodulo -17.5,3}"
echo "fmodulo 17.5,-3 = {fmodulo 17.5,-3}"
echo "(Expected: 2.5, 0.5, -0.5)"
echo ""

# Test 10: idiv with remainder: named arg
echo "Test 10: idiv with remainder: true"
result: {idiv 17,5, remainder: true}
echo "idiv 17,5 remainder:true = ~result"
result: {idiv -17,5, remainder: true}
echo "idiv -17,5 remainder:true = ~result"
echo "(Expected: [3 2], [-4 -2])"
echo ""

# Test 11: idiv with modulo: named arg
echo "Test 11: idiv with modulo: true"
result: {idiv 17,5, modulo: true}
echo "idiv 17,5 modulo:true = ~result"
result: {idiv -17,5, modulo: true}
echo "idiv -17,5 modulo:true = ~result"
echo "(Expected: [3 2], [-4 3])"
echo ""

# Test 12: fdiv with remainder: named arg
echo "Test 12: fdiv with remainder: true"
result: {fdiv 17,5, remainder: true}
echo "fdiv 17,5 remainder:true = ~result"
result: {fdiv 17.5,3, remainder: true}
echo "fdiv 17.5,3 remainder:true = ~result"
echo "(Expected: [3.4 2], [5.833... -0.5])"
echo ""

# Test 13: fdiv with modulo: named arg
echo "Test 13: fdiv with modulo: true"
result: {fdiv 17,5, modulo: true}
echo "fdiv 17,5 modulo:true = ~result"
result: {fdiv -17,5, modulo: true}
echo "fdiv -17,5 modulo:true = ~result"
echo "(Expected: [3.4 2], [-3.4 3])"
echo ""

# Test 14: floor
echo "Test 14: floor"
echo "floor 3.7 = {floor 3.7}"
echo "floor 3.2 = {floor 3.2}"
echo "floor -3.7 = {floor -3.7}"
echo "floor -3.2 = {floor -3.2}"
echo "floor 5 = {floor 5}"
echo "(Expected: 3, 3, -4, -4, 5)"
echo ""

# Test 15: ceil
echo "Test 15: ceil"
echo "ceil 3.7 = {ceil 3.7}"
echo "ceil 3.2 = {ceil 3.2}"
echo "ceil -3.7 = {ceil -3.7}"
echo "ceil -3.2 = {ceil -3.2}"
echo "ceil 5 = {ceil 5}"
echo "(Expected: 4, 4, -3, -3, 5)"
echo ""

# Test 16: trunc (towards zero)
echo "Test 16: trunc (towards zero)"
echo "trunc 3.7 = {trunc 3.7}"
echo "trunc 3.2 = {trunc 3.2}"
echo "trunc -3.7 = {trunc -3.7}"
echo "trunc -3.2 = {trunc -3.2}"
echo "trunc 5 = {trunc 5}"
echo "(Expected: 3, 3, -3, -3, 5)"
echo ""

# Test 17: round (half away from zero)
echo "Test 17: round (half away from zero)"
echo "round 3.7 = {round 3.7}"
echo "round 3.2 = {round 3.2}"
echo "round 3.5 = {round 3.5}"
echo "round -3.5 = {round -3.5}"
echo "round 2.5 = {round 2.5}"
echo "(Expected: 4, 3, 4, -4, 3)"
echo ""

# Test 18: abs
echo "Test 18: abs"
echo "abs 42 = {abs 42}"
echo "abs -42 = {abs -42}"
echo "abs 0 = {abs 0}"
echo "abs -3.14 = {abs -3.14}"
echo "(Expected: 42, 42, 0, 3.14)"
echo ""

# Test 19: min (variadic)
echo "Test 19: min (variadic)"
echo "min 5 = {min 5}"
echo "min 5,3 = {min 5,3}"
echo "min 5,2,8,1,9 = {min 5,2,8,1,9}"
echo "min -5,2,-8,1 = {min -5,2,-8,1}"
echo "min 3.14,2.71,1.41 = {min 3.14,2.71,1.41}"
echo "(Expected: 5, 3, 1, -8, 1.41)"
echo ""

# Test 20: max (variadic)
echo "Test 20: max (variadic)"
echo "max 5 = {max 5}"
echo "max 5,3 = {max 5,3}"
echo "max 5,2,8,1,9 = {max 5,2,8,1,9}"
echo "max -5,2,-8,1 = {max -5,2,-8,1}"
echo "max 3.14,2.71,1.41 = {max 3.14,2.71,1.41}"
echo "(Expected: 5, 5, 9, 2, 3.14)"
echo ""

# Test 21: Combining operations
echo "Test 21: Combining operations"
echo "abs {sub 5,10} = {abs {sub 5,10}}"
echo "floor {fdiv 17,5} = {floor {fdiv 17,5}}"
echo "max {abs -5},{abs -3},{abs -8} = {max {abs -5},{abs -3},{abs -8}}"
echo "add {mul 2,3},{mul 4,5} = {add {mul 2,3},{mul 4,5}}"
echo "(Expected: 5, 3, 8, 26)"
echo ""

# Test 22: Division with multiple divisors (product)
echo "Test 22: Division with multiple divisors"
echo "idiv 120,2,3,4 = {idiv 120,2,3,4}"
echo "fdiv 100,2,5 = {fdiv 100,2,5}"
echo "iremainder 100,3,3 = {iremainder 100,3,3}"
echo "imodulo 100,3,3 = {imodulo 100,3,3}"
echo "(Expected: 5, 10, 1, 1)"
echo ""

# Test 23: Edge cases with zero
echo "Test 23: Edge cases"
echo "add 0,0 = {add 0,0}"
echo "mul 0,100 = {mul 0,100}"
echo "sub 0,5 = {sub 0,5}"
echo "floor 0.0 = {floor 0.0}"
echo "abs 0 = {abs 0}"
echo "(Expected: 0, 0, -5, 0, 0)"
echo ""

# Test 24: Large numbers
echo "Test 24: Large numbers"
echo "add 1000000,2000000 = {add 1000000,2000000}"
echo "mul 10000,10000 = {mul 10000,10000}"
echo "idiv 1000000,1000 = {idiv 1000000,1000}"
echo "(Expected: 3000000, 100000000, 1000)"
echo ""

echo "=== All Math Tests Complete ==="
